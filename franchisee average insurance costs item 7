Analyze the provided document containing insurance policy information for franchisees associated with a specified franchise brand. The document includes columns such as "Policy Number," "Carrier," "Lines of Business," "Insured," "Referral Source Name," "Effective Date," and "Annual Premium."
Identify Franchisees: Filter the data to include only those entries where the "Referral Source Name" matches the specified franchise brand (provided by the user).
Aggregate Premiums: For each unique "Insured" under the specified franchise brand, sum all associated "Annual Premium" values to calculate the total annual premium for that "Insured." Handle cases where an "Insured" has multiple policies (e.g., different "Lines of Business" like Commercial Auto, Worker's Compensation, etc.) by combining them into a single total.
Exclusion Option: If instructed, exclude a specific "Insured" (e.g., the franchise brandâ€™s own entity) from the statistical calculations. The user will specify the entity to omit, if any.
Calculate Statistics: Using the total annual premiums for each "Insured" (after applying any exclusions), compute the following:

Average Annual Premium: Sum of all total premiums divided by the number of included "Insured" entities.
Median Annual Premium: The middle value when all total premiums are sorted in ascending order. If the number of "Insured" entities is even, average the two middle values.
High Annual Premium: The largest total premium among the included "Insured" entities.

Output: Present the results in a clear format, listing:
Average Annual Premium
Median Annual Premium
High Annual Premium Include the franchise brand name in the output for context. Provide the number of "Insured" entities included in the calculations for transparency.

Edge Cases:
If an "Annual Premium" is $0.00, note it and decide whether to include it based on context (e.g., exclude if it appears to be an error or placeholder).
If duplicate policies exist for the same "Insured" (e.g., multiple Commercial Auto policies), use the highest premium unless otherwise instructed.
If no data exists for the specified franchise brand, return a message indicating this.

Example:
Suppose the user requests: "Analyze the document for franchisees under the franchise brand 'Example Franchise Co.' and exclude 'Example Franchise Co. Main' from the calculations." Assume three "Insured" entities are found:
Insured A: $5,000 (Business Owners) + $3,000 (Worker's Compensation) = $8,000
Insured B: $12,000 (Commercial Package) = $12,000
Example Franchise Co. Main: $20,000 (excluded)

Output: For franchise brand "Example Franchise Co." (excluding "Example Franchise Co. Main"):
Average Annual Premium: $10,000
Median Annual Premium: $10,000 (average of $8,000 and $12,000)
High Annual Premium: $12,000
